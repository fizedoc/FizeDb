=========
数据库
=========


::

    使用该类静态方法来便捷的进行SQL操作


+-------------+---------+
|属性         |值       |
+=============+=========+
|命名空间     |fize\\db |
+-------------+---------+
|类名         |Db       |
+-------------+---------+


:方法:


+-----------------+-----------------------------------------------+
|方法名           |说明                                           |
+=================+===============================================+
|`__construct()`_ |初始化                                         |
+-----------------+-----------------------------------------------+
|`connect()`_     |取得一个新的连接                               |
+-----------------+-----------------------------------------------+
|`query()`_       |执行一个SQL语句并返回相应结果                  |
+-----------------+-----------------------------------------------+
|`startTrans()`_  |开始事务                                       |
+-----------------+-----------------------------------------------+
|`commit()`_      |执行事务                                       |
+-----------------+-----------------------------------------------+
|`rollback()`_    |回滚事务                                       |
+-----------------+-----------------------------------------------+
|`table()`_       |指定当前要操作的表,支持链式调用                |
+-----------------+-----------------------------------------------+
|`getLastSql()`_  |获取最后运行的SQL                              |
+-----------------+-----------------------------------------------+


方法
======
__construct()
-------------
初始化

.. code-block:: php

  public function __construct (
      string $type,
      array $config,
      string $mode = null
  )


:参数:
  +-------+-------------------+
  |名称   |说明               |
  +=======+===================+
  |type   |数据库类型         |
  +-------+-------------------+
  |config |数据库配置项       |
  +-------+-------------------+
  |mode   |连接模式           |
  +-------+-------------------+
  
  


connect()
---------
取得一个新的连接

.. code-block:: php

  public static function connect (
      string $type,
      array $config,
      string $mode = null
  ) : \fize\db\definition\Db


:参数:
  +-------+-------------------+
  |名称   |说明               |
  +=======+===================+
  |type   |数据库类型         |
  +-------+-------------------+
  |config |数据库配置项       |
  +-------+-------------------+
  |mode   |连接模式           |
  +-------+-------------------+
  
  


query()
-------
执行一个SQL语句并返回相应结果

.. code-block:: php

  public static function query (
      string $sql,
      array $params = [],
      callable $callback = null
  ) : mixed


:参数:
  +---------+----------------------------------------------------------------------------------+
  |名称     |说明                                                                              |
  +=========+==================================================================================+
  |sql      |SQL语句，支持原生的pdo问号预处理                                                  |
  +---------+----------------------------------------------------------------------------------+
  |params   |可选的绑定参数                                                                    |
  +---------+----------------------------------------------------------------------------------+
  |callback |如果定义该记录集回调函数则不返回数组而直接进行循环回调                            |
  +---------+----------------------------------------------------------------------------------+
  
  

:返回值:
  SELECT语句返回数组，INSERT/REPLACE返回自增ID，其余返回受影响行数。


startTrans()
------------
开始事务

.. code-block:: php

  public static function startTrans ()



commit()
--------
执行事务

.. code-block:: php

  public static function commit ()



rollback()
----------
回滚事务

.. code-block:: php

  public static function rollback ()



table()
-------
指定当前要操作的表,支持链式调用

.. code-block:: php

  public static function table (
      string $name,
      string $prefix = null
  ) : \fize\db\definition\Db


:参数:
  +-------+--------------------------------------------------+
  |名称   |说明                                              |
  +=======+==================================================+
  |name   |表名                                              |
  +-------+--------------------------------------------------+
  |prefix |表前缀，默认为null表示使用当前前缀                |
  +-------+--------------------------------------------------+
  
  


getLastSql()
------------
获取最后运行的SQL

.. code-block:: php

  public static function getLastSql (
      bool $real = false
  ) : string


:参数:
  +-------+-------------------------------------------------+
  |名称   |说明                                             |
  +=======+=================================================+
  |real   |是否返回最终SQL语句而非预处理语句                |
  +-------+-------------------------------------------------+
  
  


::

    仅供日志使用的SQL语句，由于本身存在SQL危险请不要真正用于执行


