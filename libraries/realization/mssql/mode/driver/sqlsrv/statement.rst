============
处理语句
============


+-------------+---------------------------------------------------+
|属性         |值                                                 |
+=============+===================================================+
|命名空间     |fize\\db\\realization\\mssql\\mode\\driver\\sqlsrv |
+-------------+---------------------------------------------------+
|类名         |Statement                                          |
+-------------+---------------------------------------------------+


:方法:


+--------------------+-------------------------------------------------------------------------------------------------+
|方法名              |说明                                                                                             |
+====================+=================================================================================================+
|`__construct()`_    |构造                                                                                             |
+--------------------+-------------------------------------------------------------------------------------------------+
|`__destruct()`_     |析构                                                                                             |
+--------------------+-------------------------------------------------------------------------------------------------+
|`cancel()`_         |取消预处理对象，但其可以再次使用execute方法运行                                                  |
+--------------------+-------------------------------------------------------------------------------------------------+
|`execute()`_        |执行当前预处理对象。                                                                             |
+--------------------+-------------------------------------------------------------------------------------------------+
|`fetchArray()`_     |以数组形式遍历记录集                                                                             |
+--------------------+-------------------------------------------------------------------------------------------------+
|`fetchObject()`_    |以对象形式遍历记录集                                                                             |
+--------------------+-------------------------------------------------------------------------------------------------+
|`fetch()`_          |执行该行数后指针指向下一个记录行                                                                 |
+--------------------+-------------------------------------------------------------------------------------------------+
|`fieldMetadata()`_  |检索准备好的语句字段的元数据。                                                                   |
+--------------------+-------------------------------------------------------------------------------------------------+
|`freeStmt()`_       |释放当前预处理语句的所有资源                                                                     |
+--------------------+-------------------------------------------------------------------------------------------------+
|`getField()`_       |获取当前行的指定字段值                                                                           |
+--------------------+-------------------------------------------------------------------------------------------------+
|`hasRows()`_        |判断当前预处理结果是否有记录                                                                     |
+--------------------+-------------------------------------------------------------------------------------------------+
|`nextResult()`_     |将指针移动到下个记录集                                                                           |
+--------------------+-------------------------------------------------------------------------------------------------+
|`numFields()`_      |获取当前记录集的字段个数                                                                         |
+--------------------+-------------------------------------------------------------------------------------------------+
|`numRows()`_        |获取当前记录集的记录个数                                                                         |
+--------------------+-------------------------------------------------------------------------------------------------+
|`rowsAffected()`_   |返回当前预处理语句的影响行数。                                                                   |
+--------------------+-------------------------------------------------------------------------------------------------+
|`sendStreamData()`_ |如果绑定参数中含有流式数据，需要以此方法发送数据到数据库服务器。                                 |
+--------------------+-------------------------------------------------------------------------------------------------+


方法
======
__construct()
-------------
构造

.. code-block:: php

  public function __construct (
      resource &$statement
  )


:参数:
  +----------+----------------------------+
  |名称      |说明                        |
  +==========+============================+
  |statement |预处理语句资源对象          |
  +----------+----------------------------+
  
  


__destruct()
------------
析构

.. code-block:: php

  public function __destruct ()



cancel()
--------
取消预处理对象，但其可以再次使用execute方法运行

.. code-block:: php

  public function cancel () : bool


:返回值:
  成功时返回 TRUE， 或者在失败时返回 FALSE，如果当前没有预处理对象也返回false。


execute()
---------
执行当前预处理对象。

.. code-block:: php

  public function execute () : bool


:返回值:
  成功时返回 TRUE， 或者在失败时返回 FALSE。


fetchArray()
------------
以数组形式遍历记录集

.. code-block:: php

  public function fetchArray (
      callable $func,
      int $fetchType = 2,
      int $row = null,
      int $offset = 0
  )


:参数:
  +----------+-------------------+
  |名称      |说明               |
  +==========+===================+
  |func      |遍历函数           |
  +----------+-------------------+
  |fetchType |指定遍历类型       |
  +----------+-------------------+
  |row       |设置游标类型       |
  +----------+-------------------+
  |offset    |设置偏移量         |
  +----------+-------------------+
  
  


fetchObject()
-------------
以对象形式遍历记录集

.. code-block:: php

  public function fetchObject (
      callable $func,
      string $className = null,
      array $ctorParams = null,
      int $row = 6,
      int $offset = null
  )


:参数:
  +-----------+-------------------------------------------------------------------------------------+
  |名称       |说明                                                                                 |
  +===========+=====================================================================================+
  |func       |遍历函数                                                                             |
  +-----------+-------------------------------------------------------------------------------------+
  |className  |指定要生成实例的对象名，如果不指定，则生成其自身对象实例                             |
  +-----------+-------------------------------------------------------------------------------------+
  |ctorParams |如果对象实例化需要参数，则在此填写                                                   |
  +-----------+-------------------------------------------------------------------------------------+
  |row        |设置游标类型                                                                         |
  +-----------+-------------------------------------------------------------------------------------+
  |offset     |设置偏移量                                                                           |
  +-----------+-------------------------------------------------------------------------------------+
  
  


fetch()
-------
执行该行数后指针指向下一个记录行

.. code-block:: php

  public function fetch (
      int $row = null,
      int $offset = null
  ) : mixed


:参数:
  +-------+-------------------+
  |名称   |说明               |
  +=======+===================+
  |row    |设置游标类型       |
  +-------+-------------------+
  |offset |设置偏移量         |
  +-------+-------------------+
  
  

:返回值:
  成功返回true，失败返回false，没有更多记录时返回null


fieldMetadata()
---------------
检索准备好的语句字段的元数据。

.. code-block:: php

  public function fieldMetadata () : array


:返回值:
  失败是返回false


freeStmt()
----------
释放当前预处理语句的所有资源

.. code-block:: php

  public function freeStmt () : bool


:返回值:
  成功时返回 TRUE， 或者在失败时返回 FALSE。


getField()
----------
获取当前行的指定字段值

.. code-block:: php

  public function getField (
      int $fieldIndex,
      int $getAsType = null
  ) : mixed


:参数:
  +-----------+-----------------------------+
  |名称       |说明                         |
  +===========+=============================+
  |fieldIndex |字段下标，以0开始。          |
  +-----------+-----------------------------+
  |getAsType  |指定类型。                   |
  +-----------+-----------------------------+
  
  


hasRows()
---------
判断当前预处理结果是否有记录

.. code-block:: php

  public function hasRows () : bool



nextResult()
------------
将指针移动到下个记录集

.. code-block:: php

  public function nextResult () : mixed


:返回值:
  成功返回true，失败返回false，没有更多记录集时返回null


numFields()
-----------
获取当前记录集的字段个数

.. code-block:: php

  public function numFields () : int


:返回值:
  如果失败返回false


numRows()
---------
获取当前记录集的记录个数

.. code-block:: php

  public function numRows () : int


:返回值:
  如果失败返回false


rowsAffected()
--------------
返回当前预处理语句的影响行数。

.. code-block:: php

  public function rowsAffected () : int



sendStreamData()
----------------
如果绑定参数中含有流式数据，需要以此方法发送数据到数据库服务器。

.. code-block:: php

  public function sendStreamData () : bool


:返回值:
  成功返回true，失败返回false。


